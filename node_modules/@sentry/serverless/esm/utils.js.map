{"version":3,"file":"utils.js","sources":["../../../src/utils.ts"],"sourcesContent":["import { runWithAsyncContext } from '@sentry/core';\nimport type { Scope } from '@sentry/types';\nimport { addExceptionMechanism } from '@sentry/utils';\n\n/**\n * @param fn function to run\n * @returns function which runs in the newly created domain or in the existing one\n */\nexport function domainify<A extends unknown[], R>(fn: (...args: A) => R): (...args: A) => R | void {\n  return (...args) => runWithAsyncContext(() => fn(...args), { reuseExisting: true });\n}\n\n/**\n * @param source function to be wrapped\n * @param wrap wrapping function that takes source and returns a wrapper\n * @param overrides properties to override in the source\n * @returns wrapped function\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function proxyFunction<A extends any[], R, F extends (...args: A) => R>(\n  source: F,\n  wrap: (source: F) => F,\n  overrides?: Record<PropertyKey, unknown>,\n): F {\n  const wrapper = wrap(source);\n  const handler: ProxyHandler<F> = {\n    apply: <T>(_target: F, thisArg: T, args: A) => {\n      return wrapper.apply(thisArg, args);\n    },\n  };\n\n  if (overrides) {\n    handler.get = (target, prop) => {\n      if (Object.prototype.hasOwnProperty.call(overrides, prop)) {\n        return overrides[prop as string];\n      }\n      return (target as Record<PropertyKey, unknown>)[prop as string];\n    };\n  }\n\n  return new Proxy(source, handler);\n}\n\n/**\n * Marks an event as unhandled by adding a span processor to the passed scope.\n */\nexport function markEventUnhandled(scope: Scope): Scope {\n  scope.addEventProcessor(event => {\n    addExceptionMechanism(event, { handled: false });\n    return event;\n  });\n\n  return scope;\n}\n"],"names":[],"mappings":";;;AAIA;AACA;AACA;AACA;AACO,SAAS,SAAS,CAAyB,EAAE,EAA+C;AACnG,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK,mBAAmB,CAAC,MAAM,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,EAAE,aAAa,EAAE,IAAK,EAAC,CAAC,CAAA;AACrF,CAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,aAAa;AAC7B,EAAE,MAAM;AACR,EAAE,IAAI;AACN,EAAE,SAAS;AACX,EAAK;AACL,EAAE,MAAM,OAAQ,GAAE,IAAI,CAAC,MAAM,CAAC,CAAA;AAC9B,EAAE,MAAM,OAAO,GAAoB;AACnC,IAAI,KAAK,EAAE,CAAI,OAAO,EAAK,OAAO,EAAK,IAAI,KAAQ;AACnD,MAAM,OAAO,OAAO,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;AACzC,KAAK;AACL,GAAG,CAAA;AACH;AACA,EAAE,IAAI,SAAS,EAAE;AACjB,IAAI,OAAO,CAAC,GAAI,GAAE,CAAC,MAAM,EAAE,IAAI,KAAK;AACpC,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,EAAE;AACjE,QAAQ,OAAO,SAAS,CAAC,IAAA,EAAe,CAAA;AACxC,OAAM;AACN,MAAM,OAAO,CAAC,MAAA,GAAwC,MAAe,CAAA;AACrE,KAAK,CAAA;AACL,GAAE;AACF;AACA,EAAE,OAAO,IAAI,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACnC,CAAA;AACA;AACA;AACA;AACA;AACO,SAAS,kBAAkB,CAAC,KAAK,EAAgB;AACxD,EAAE,KAAK,CAAC,iBAAiB,CAAC,SAAS;AACnC,IAAI,qBAAqB,CAAC,KAAK,EAAE,EAAE,OAAO,EAAE,KAAM,EAAC,CAAC,CAAA;AACpD,IAAI,OAAO,KAAK,CAAA;AAChB,GAAG,CAAC,CAAA;AACJ;AACA,EAAE,OAAO,KAAK,CAAA;AACd;;;;"}